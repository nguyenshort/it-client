<template>
  <lazy-template-session title="Done Project">

    <ul>
      <li
        v-for="(project, index) in projects"
        :key="index"
        class="mb-5 last:mb-0"
      >
        <div class="custom-shadow rounded-lg flex overflow-hidden items-center">

          <div class="pl-6 py-5">
            <nuxt-link
              :to="$link().product(project)"
              class="block w-[35px] aspect-1 overflow-hidden flex-shrink-0"
            >
              <img class="w-full h-full object-contain" :src="'http://localhost:5001' + project.logo" alt=""/>
            </nuxt-link>
          </div>

          <div class="px-6 py-5 flex flex-col">
            <nuxt-link
              :to="$link().product(project)"
            >
              <h2 class="text-[15px] font-semibold text-gray-700 mb-0">{{ project.name }}</h2>
            </nuxt-link>

            <div class="mt-1 flex items-center">
              <a v-if="project.link" :href="project.link" target="_blank" class="flex items-center">
                <span>
                  <i-ph-link-simple-fill/>
                </span>
                <span class="ml-1">{{ project.link }}</span>
              </a>

              <span v-if="project.link" class="h-[15px] w-px bg-gray-200 block mx-3"></span>

              <div class="flex items-center text-xs text-gray-500">
                <span>
                  <i-iconoir-chat-bubble/>
                </span>
                <span class="ml-1 relative mt-0.5">
                  {{ project.comments }} bình luận
                </span>
              </div>

              <span class="h-[15px] w-px bg-gray-200 block mx-3"></span>

              <div class="flex items-center text-xs text-gray-500">
                <span>
                  <i-octicon-issue-draft-16/>
                </span>
                <span class="ml-1 relative mt-0.5">
                  {{ project.bookmarks }} issues
                </span>
              </div>

            </div>

          </div>

          <div class="ml-2 px-6 py-5 flex flex-col">
            <h2 class="text-[13px] font-semibold text-gray-700 mb-0">Bắt Đầu</h2>

            <div class="mt-1 flex items-center text-gray-500 text-xs">
              <div class="flex items-center">
                <span>
                  <i-mdi-clock-outline />
                </span>
                <span class="ml-1">12/08/2022</span>
              </div>
            </div>

          </div>

          <div class="ml-2 px-6 py-5 flex flex-col">
            <h2 class="text-[13px] font-semibold text-gray-700 mb-0">Kết Thúc</h2>

            <div class="mt-1 flex items-center text-gray-500 text-xs">
              <div class="flex items-center">
                <span>
                  <i-ant-design-flag-outlined />
                </span>
                <span class="ml-1">05/08/2022</span>
              </div>
            </div>

          </div>


          <div
            class="relative h-[35px] ml-auto mr-6"
            :style='{
                width: `${4 * 20}px`,
              }'
          >
            <button
              v-for="index4 in 3"
              :key="index4"
              class="absolute top-0 left-0 h-full w-[35px] overflow-hidden rounded-full border-2 border-white"
              :style="{
                  transform: 'translateX(' + (index4 - 1) * 20 + 'px)',
                  zIndex: index4
                }"
            >
              <img
                class="h-full w-full transform object-cover transition hover:scale-105"
                src="/images/avatar.jpeg"
                alt=""
              />
            </button>
          </div>

          <button class="flex items-center mr-6 bg-gradient-to-r from-primary-500 to-primary-700 text-white px-3 py-2 rounded-full shadow-lg shadow-primary-200">
            <span class="text-xs font-semibold mr-1">Đánh Giá</span>
            <i-material-symbols-arrow-circle-right />
          </button>

        </div>
      </li>
    </ul>

  </lazy-template-session>
</template>

<script lang="ts" setup>
import { computed, reactive, useAsyncQuery } from "#imports";
import { ProjectStatus } from "~/__generated__/shinzoTypes";
import { GET_HOME_DONE } from "~/apollo/shinzo/queries/coupon.query";
import { GetHomeDone, GetHomeDoneVariables } from "~/apollo/shinzo/queries/__generated__/GetHomeDone";

const variables = reactive<GetHomeDoneVariables>({
  filter: {
    limit: 4,
    offset: 0,
    sort: 'updatedAt',
    status:ProjectStatus.DONE
  }
})
const { data } = await useAsyncQuery<GetHomeDone>(GET_HOME_DONE, variables)
const projects = computed(() => data.value?.projects || [])

</script>
